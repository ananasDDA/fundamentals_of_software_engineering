# –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –†–ê–ë–û–¢–ê ‚Ññ2

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã UML-–¥–∏–∞–≥—Ä–∞–º–º—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ Mermaid, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –≤ GitHub. –î–∏–∞–≥—Ä–∞–º–º—ã –æ—Ç—Ä–∞–∂–∞—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ CaseGenius (RAG-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏—Ö –∫–µ–π—Å–æ–≤).

## 1) System Component Diagram ‚Äî –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ CaseGenius

```mermaid
flowchart TB
  A((üßç‚Äç‚ôÇ)) --> B[API Gateway]
  B --> C[Auth Service]
  B --> D[Case Generation Service]
  B --> E[Feedback Service]

  D --> F[RAG Engine]
  F --> G[Vector DB]
  F --> H[LLM API]

  E --> H
  E --> I[Evaluation Logic]

  G --> J[Knowledge Base]
  D --> K[(PostgreSQL User Profiles)]
  E --> K
```

## 2) Domain Model (Class Diagram) ‚Äî –∫–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

```mermaid
classDiagram
  class User {
    +UUID id
    +string email
    +string role
    +JSONB competency_profile
    +datetime created_at
  }

  class KnowledgeChunk {
    +UUID id
    +text content
    +vector embedding
    +JSONB metadata
    +UUID document_id
  }

  class CaseParameters {
    +string competency
    +string industry
    +string difficulty_level
    +UUID user_id
  }

  class GeneratedCase {
    +UUID id
    +UUID user_id
    +text case_text
    +JSONB parameters
    +JSONB context_sources
    +text feedback_text
    +datetime created_at
  }

  User "1" --o "*" GeneratedCase : —Å–æ–∑–¥–∞—ë—Ç
  GeneratedCase o-- CaseParameters : –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  KnowledgeChunk <.. GeneratedCase : –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (RAG)
```

## 3) RAG Pipeline (Activity) ‚Äî –ø–æ—Ç–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π

```mermaid
flowchart TD
  A[–ó–∞–ø—Ä–æ—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–µ–π—Å–∞] --> B[–í—ã—á–∏—Å–ª–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–∞]
  B --> C[Vector DB: similarity search k=3]
  C --> D[–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º]
  D --> E[LLM: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –∫–µ–π—Å–∞]
  E --> F[–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–µ–π—Å –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏]
  F --> G[–í–µ—Ä–Ω—É—Ç—å case_id –∏ case_text]
```

## 4) Sequence Diagram ‚Äî API —Å—Ü–µ–Ω–∞—Ä–∏–∏

```mermaid
sequenceDiagram
  participant C as Client (Web)
  participant G as API Gateway
  participant CG as Case Generation Service
  participant R as RAG Engine
  participant V as Vector DB
  participant L as LLM API
  participant DB as PostgreSQL

  Note over C,G: POST /api/v1/generate-case
  C->>G: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (competency, industry, difficulty_level, user_id)
  G->>CG: –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  CG->>R: retrieve_context(query, filters)
  R->>V: similarity_search(embedding, k=3)
  V-->>R: —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏
  R-->>CG: –∫–æ–Ω—Ç–µ–∫—Å—Ç
  CG->>L: prompt(context + –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
  L-->>CG: case_text
  CG->>DB: save(case, sources, params)
  DB-->>CG: case_id
  CG-->>G: case_id, case_text, context_sources
  G-->>C: JSON –æ—Ç–≤–µ—Ç

  Note over C,G: POST /api/v1/submit-solution
  C->>G: case_id, user_solution, user_id
  G->>CG: –ø–æ–ª—É—á–∏—Ç—å –∫–µ–π—Å
  CG->>DB: load(case)
  DB-->>CG: case
  CG->>L: –æ—Ü–µ–Ω–∫–∞/feedback prompt
  L-->>CG: feedback_text, bullets
  CG->>DB: save(feedback)
  CG-->>G: feedback
  G-->>C: JSON –æ—Ç–≤–µ—Ç
```

## 5) Data Model (ER) ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

```mermaid
erDiagram
  USERS ||--o{ GENERATED_CASES : creates
  KNOWLEDGE_CHUNKS ||--o{ GENERATED_CASES : provides_context

  USERS {
    UUID id PK
    VARCHAR email
    VARCHAR role
    JSONB competency_profile
    TIMESTAMP created_at
  }

  KNOWLEDGE_CHUNKS {
    UUID id PK
    TEXT content
    VECTOR embedding
    JSONB metadata
    UUID document_id
  }

  GENERATED_CASES {
    UUID id PK
    UUID user_id FK
    TEXT case_text
    JSONB parameters
    JSONB context_sources
    TEXT feedback_text
    TIMESTAMP created_at
  }
```

---

–ö—Ä–∞—Ç–∫–∏–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –î–∏–∞–≥—Ä–∞–º–º—ã –æ—Ç—Ä–∞–∂–∞—é—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É MVP ¬´CaseGenius¬ª (RAG + LLM).